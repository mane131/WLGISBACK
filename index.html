<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Utilities</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    }
  </script>
  <style>
    /* Glow hover */
    .glow:hover {
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
      transform: translateY(-4px);
    }

    /* Music control button */
    #musicControl {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 60;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: solid rgba(255, 255, 255, 0.2);
      border-radius: 9999px;
      padding: 10px 16px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    #musicControl:hover {
      box-shadow: 0 0 12px rgba(255, 255, 255, 0.5);
      transform: scale(1.05);
    }

    /* Loading screen */
    #loading {
      position: fixed;
      inset: 0;
      background: black;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
  </style>
</head>
<body class="bg-white text-black dark:bg-black dark:text-white transition-colors duration-300">

  <!-- Hidden Music Player -->
  <audio id="bgMusic" src="Websites Music.mp3"></audio>

  <!-- Music Control Button -->
  <button id="musicControl">▶ Play Music</button>

  <!-- Loading Screen -->
  <div id="loading">
    <div class="animate-pulse text-xl font-semibold">Loading Utilities…</div>
  </div>

  <!-- Top Navigation -->
  <header class="sticky top-0 z-40 border-b border-black/10 bg-white/80 backdrop-blur-md transition-colors dark:border-white/10 dark:bg-black/60">
    <div class="mx-auto flex max-w-6xl items-center justify-between px-6 py-4">
      <a href="#websites" class="font-semibold tracking-tight">
        <span class="select-none">prox<span class="opacity-40">.links.one</span></span>
      </a>
      <button id="themeToggle" class="px-3 py-1 border rounded-lg text-sm transition hover:bg-gray-200 dark:hover:bg-gray-800">Toggle Theme</button>
    </div>
  </header>

  <!-- Gallery -->
  <section id="websites" class="mx-auto max-w-6xl px-6 py-20">
    <h2 class="text-2xl font-semibold tracking-tight mb-10">Utilities</h2>
    <div id="grid" class="grid gap-6 sm:grid-cols-2 md:grid-cols-3"></div>
  </section>

  <script>
    // List of sites
    const sites = [
      "https://solidcoding.krewedegroove.com/",
      "https://fnrkrbvtpy.abbotsfordhallforhire.org.au/",
      "https://iwpsy.anchorchain.co.za/",
      "https://jesusisking.autoluc.cl/",
      "https://dwerk.conyser.cl/",
      "https://sdiybt.justanothersite.net/",
      "https://jcw87.github.io/c2-sans-fight/",
      "https://nullsto.edu.pl/",
      "https://cookieclickerunblocked.github.io/"
    ];

    const grid = document.getElementById("grid");

    // Fetch <title> from websites
    async function getTitle(url) {
      try {
        const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(url)}`);
        const data = await response.json();
        const match = data.contents.match(/<title>(.*?)<\/title>/i);
        return match ? match[1] : url;
      } catch {
        return null;
      }
    }

    // Check if website is reachable
    async function checkSite(url) {
      try {
        const res = await fetch(url, { method: "HEAD", mode: "no-cors" });
        return true;
      } catch {
        return false;
      }
    }

    // Build cards
    async function buildCards() {
      for (const site of sites) {
        try {
          const isAlive = await checkSite(site);
          if (!isAlive) continue;

          const title = await getTitle(site);
          if (!title) continue;

          const card = document.createElement("a");
          card.href = site;
          card.target = "_blank";
          card.className =
            "glow block rounded-2xl border border-gray-300 dark:border-gray-700 p-6 transition transform bg-white dark:bg-gray-900";

          card.innerHTML = `
            <div class="text-center font-medium mb-3">${title}</div>
            <img src="https://image.thum.io/get/width/600/crop/800/${site}" 
                 alt="preview" 
                 class="rounded-lg w-full object-contain bg-black">
            <div class="mt-4 text-center text-lg font-semibold">Click Here</div>
          `;
          grid.appendChild(card);
        } catch (e) {
          console.log("Failed to load site:", site, e);
        }
      }
      document.getElementById("loading").style.display = "none";
    }
    buildCards();

    // Theme toggle
    const html = document.documentElement;
    const themeToggle = document.getElementById("themeToggle");
    if (localStorage.theme === "dark") {
      html.classList.add("dark");
    } else {
      html.classList.remove("dark");
    }
    themeToggle.addEventListener("click", () => {
      html.classList.toggle("dark");
      localStorage.theme = html.classList.contains("dark") ? "dark" : "light";
    });

    // Background Music Logic
    const music = document.getElementById("bgMusic");
    const musicControl = document.getElementById("musicControl");
    let isPlaying = false;

    // Try autoplay on load
    window.addEventListener("load", () => {
      music.play().then(() => {
        isPlaying = true;
        musicControl.textContent = "⏸ Pause Music";
      }).catch(() => {
        console.log("Autoplay blocked — waiting for user interaction.");
      });
    });

    // Loop after full track
    music.addEventListener("ended", () => {
      music.currentTime = 0;
      music.play();
    });

    // Toggle play/pause
    musicControl.addEventListener("click", () => {
      if (isPlaying) {
        music.pause();
        isPlaying = false;
        musicControl.textContent = "▶ Play Music";
      } else {
        music.play();
        isPlaying = true;
        musicControl.textContent = "⏸ Pause Music";
      }
    });
  </script>
</body>
</html>
